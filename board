import socketio

# Connexion au serveur Flask-SocketIO
sio = socketio.Client()

@sio.event
def connect():
    print("ğŸ”Œ ConnectÃ© au serveur Flask-SocketIO")

@sio.event
def disconnect():
    print("ğŸ”Œ DÃ©connectÃ© du serveur")

@sio.on("update_board")
def update_board(data):
    board = data.get("board", [])
    print("\nğŸ“œ Nouveau plateau :")
    for row in board:
        print(" ".join(row))
    print()

try:
    sio.connect('http://127.0.0.1:5000')

    while True:
        move = input("ğŸ“ Entre ton coup (ex: d5 d4) ou 'exit' pour quitter : ").strip()

        if move.lower() == "exit":
            break

        if len(move) == 5 and move[2] == ' ':
            print(f"ğŸ“¤ Envoi du coup : {move}")
            sio.emit('move_from_real_board', {'move': move})
        else:
            print("âŒ Format incorrect ! Utilise le format : d5 d4")

except Exception as e:
    print(f"âŒ Erreur : {e}")

finally:
    sio.disconnect()
